import streamlit as st
import random
import time

psyZ = [0]
psyO = [0]
psyT = [0]
usersnumbs = []
psystates = ['слышит', 'видит', 'знает', 'подозревает', 'чует', 'просёк', 'ведает']

# Initialization
if 'store' not in st.session_state:
    st.session_state.store = False
if 'users_number' not in st.session_state:
    st.session_state['users_number'] = []
if 'psyZ' not in st.session_state:
    st.session_state['psyZ'] = [0]
if 'psyO' not in st.session_state:
    st.session_state['psyO'] = [0]
if 'psyT' not in st.session_state:
    st.session_state['psyT'] = [0]
if 'psyzanswer' not in st.session_state:
    st.session_state['psyzanswer'] = [0]
if 'psyoanswer' not in st.session_state:
    st.session_state['psyoanswer'] = [0]
if 'psytanswer' not in st.session_state:
    st.session_state['psytanswer'] = [0]
if 'usersnumbs' not in st.session_state:
    st.session_state['usersnumbs'] = []
if 'ent_numb' not in st.session_state:
    st.session_state['ent_numb'] = []
if 'atext_input' not in st.session_state:
    st.session_state['atext_input']=''
#st.session_state
rnd = random.randint(0, len(psystates) - 1)
zstatus=psystates[rnd]
psystates.remove(psystates[rnd])

rnd = random.randint(0, len(psystates) - 1)
ostatus=psystates[rnd]
psystates.remove(psystates[rnd])

rnd = random.randint(0, len(psystates) - 1)
tstatus=psystates[rnd]
psystates.remove(psystates[rnd])



st.title("""
 Звонок экстрасенсам
""")
if not len(st.session_state.usersnumbs) > 0:
    st.subheader('Загадайте двухзначное число (любое!), а наши экстрасенсы - Zero, One и Two попробуют его угадать.')
else:
    st.subheader('Загадайте двухзначное число (любое!), а наши экстрасенсы - Zero, One и Two попробуют его угадать.')
    st.write('*Вы уже загадывали ' + str(st.session_state.usersnumbs)[1:-1]+'*')


st.write(f' **РЕЗУЛЬТАТЫ**\n')
st.write(f'Достоверность Zero: {str(st.session_state.psyZ[0])}, *история догадок - {str(st.session_state.psyZ[1::])}\n*')
st.write(f'Достоверность One: {str(st.session_state.psyO[0])}, *история догадок - {str(st.session_state.psyO[1::])}\n*')
st.write(f'Достоверность Two: {str(st.session_state.psyT[0])}, *история догадок - {str(st.session_state.psyT[1::])}\n*')


_opt  = st.button('Число загадано!')


# you press button, it creates text_input


if _opt or st.session_state.store:
    #st.session_state.store = True
    # you write something in it, press enter

    # psyZ Загадывает только чётные числа
    st.session_state.psyzanswer = random.randrange(10, 100, 2)
    st.session_state.psyZ.append(st.session_state.psyzanswer)

    # psyO Загадывает только нечётные числа
    st.session_state.psyoanswer = random.randrange(10 // 2, 100 // 2) * 2 + 1
    st.session_state.psyO.append(st.session_state.psyoanswer)

    # psyT Загадывает только десятки
    st.session_state.psytanswer = random.randrange(10, 100, 10)
    while st.session_state.psytanswer == st.session_state.psyzanswer:
        st.session_state.psytanswer = random.randrange(10, 100, 10)
        # print('Совпадение!')
    st.session_state.psyT.append(st.session_state.psytanswer)

    time.sleep(1)
    st.write(f'Догадки экстрасенсов:')
    time.sleep(1)
    st.write(f'Zero {zstatus} - {st.session_state.psyzanswer}')
    time.sleep(1)
    st.write(f'One {ostatus} - {st.session_state.psyoanswer}')
    time.sleep(1)
    st.write(f'Two {tstatus} - {st.session_state.psytanswer}')
    time.sleep(1)


    input = st.number_input("Напишите двухзначное число",min_value=10,max_value=99)
    #st.session_state

    if input:
        st.session_state.usersnumbs.append(input)
        if int(input) == int(st.session_state.psyzanswer):
            st.session_state.psyZ[0] += 1
            st.session_state.psyT[0] -= 1
            st.session_state.psyO[0] -= 1
        elif int(input) == int(st.session_state.psyoanswer):
            st.session_state.psyZ[0] -= 1
            st.session_state.psyT[0] -= 1
            st.session_state.psyO[0] += 1
        elif int(input) == int(st.session_state.psytanswer):
            st.session_state.psyZ[0] -= 1
            st.session_state.psyT[0] += 1
            st.session_state.psyO[0] -= 1
        else:
            st.session_state.psyZ[0] -= 1
            st.session_state.psyT[0] -= 1
            st.session_state.psyO[0] -= 1

